---
const { id } = Astro.props;
---

<div
	id={id}
	x-ref="tooltip"
	class="absolute w-auto text-sm"
	:class="{ 'top-0 left-1/2 -translate-x-1/2 -mt-0.5 -translate-y-full' : tooltipPosition == 'top', 'top-1/2 -translate-y-1/2 -ml-1.5 left-0 -translate-x-full' : tooltipPosition == 'left', 'bottom-0 left-1/2 -translate-x-1/2 -mb-0.5 translate-y-full' : tooltipPosition == 'bottom', 'top-1/2 -translate-y-1/2 -mr-1.5 right-0 translate-x-full' : tooltipPosition == 'right' }"
	x-data="{ tooltipVisible: false, tooltipText: '${tooltipText}', tooltipArrow: ${tooltipArrow}, tooltipPosition: '${tooltipPosition}' }"
	x-init="setTimeout(function(){ tooltipVisible = true; }, 1);"
	x-show="tooltipVisible"
	x-cloak
>
	<div
		x-show="tooltipVisible"
		x-transition
		class="relative py-1 px-2 text-white bg-black bg-opacity-90 rounded"
	>
		<p x-text="tooltipText" class="block flex-shrink-0 text-xs whitespace-nowrap"></p>
		<div
			x-ref="tooltipArrow"
			x-show="tooltipArrow"
			:class="{ 'bottom-0 -translate-x-1/2 left-1/2 w-2.5 translate-y-full' : tooltipPosition == 'top', 'right-0 -translate-y-1/2 top-1/2 h-2.5 -mt-px translate-x-full' : tooltipPosition == 'left', 'top-0 -translate-x-1/2 left-1/2 w-2.5 -translate-y-full' : tooltipPosition == 'bottom', 'left-0 -translate-y-1/2 top-1/2 h-2.5 -mt-px -translate-x-full' : tooltipPosition == 'right' }"
			class="inline-flex overflow-hidden absolute justify-center items-center"
		>
			<div
				:class="{ 'origin-top-left -rotate-45' : tooltipPosition == 'top', 'origin-top-left rotate-45' : tooltipPosition == 'left', 'origin-bottom-left rotate-45' : tooltipPosition == 'bottom', 'origin-top-right -rotate-45' : tooltipPosition == 'right' }"
				class="w-1.5 h-1.5 bg-black bg-opacity-90 transform"
			>
			</div>
		</div>
	</div>
</div>

<script>
	import Alpine from "alpinejs";
	class Toast extends HTMLElement {
		constructor() {
			super();

			this.addEventListener("alpine:init", () => {
				Alpine.bind(this, () => ({
					tooltipVisible: false,
					tooltipText: this.getAttribute("tooltip-text"),
					tooltipArrow: this.getAttribute("tooltip-arrow"),
					tooltipPosition: this.getAttribute("tooltip-position"),
				}));
			});
		}
	}
</script>
